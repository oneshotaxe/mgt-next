import{j as M,M as h,O as L,E as n,y as _,C as P,R as l,N as r,h as O}from"./index.ecde2a89.js";import{u as Y,f as R,a as I,r as b,b as v}from"./dayjs.b74fc854.js";const x=(s,t)=>{const{t:a}=M(),d=O(),E=h(),f=L(),m=n(()=>l[r.EMPLOYEE_BUS_LIST](s.value)),c=p=>l[r.EMPLOYEE_BUS_VIEW](s.value,p),u=n(()=>t.value?c(t.value):m.value),e=_(!1),o=P({columnId:s.value,gateId:void 0,num:""}),g=n(()=>({columnId:{required:b},num:{required:b}})),y=Y(g,o),A=n(()=>[{key:"save",text:a("actions.save"),buttonType:"submit",type:"PRIMARY",loading:e.value},{key:"cancel",text:a("actions.cancel"),to:u.value}]);return{loading:e,model:o,v$:y,actions:A,save:async()=>{if(!!await y.value.$validate())return E.confirm(a("dialogs.saveConfirm"),()=>(e.value=!0,(t.value?v.buses._id.put(t.value,o).then(()=>t.value):v.buses._id.post(o)).then(S=>(f.success(a("alerts.saveSuccess")),d.push(c(S)))).finally(()=>{e.value=!1})))},fetch:()=>(e.value=!0,v.buses._id.get(t.value).then(p=>Object.assign(o,p)).finally(()=>e.value=!1))}},U=s=>{const{t}=M(),a=O(),d=n(()=>l[r.EMPLOYEE_BUS_CREATOR](s.value)),E=e=>l[r.EMPLOYEE_BUS_VIEW](s.value,e),f=_([{key:"num",orderKey:"num",title:t("fields.num")},{key:"gate",title:t("fields.gate"),format:e=>{var o;return`${(o=e.route)==null?void 0:o.num} / ${e.num}`},to:e=>l[r.EMPLOYEE_GATE_VIEW](s.value,e.id)},{key:"createdAt",orderKey:"created_at",title:t("fields.createdAt"),format:R},{key:"updatedAt",title:t("fields.updatedAt"),format:R}]),m=I({order:"created_at desc",page:1,pageSize:10,fetch:v.buses.get,additionalParams:()=>({columnId:s.value})}),c=n(()=>[{key:"create",to:d.value,text:t("actions.create"),type:"PRIMARY",prependIcon:"mdi-plus"},{key:"toColumn",to:l[r.EMPLOYEE_COLUMN_VIEW](s.value),text:t("actions.toColumn")}]);return{columns:f,table:m,actions:c,onRowClick:e=>a.push(E(e))}},V=(s,t)=>{const{t:a}=M(),d=O(),E=h(),f=L(),m=n(()=>l[r.EMPLOYEE_BUS_EDITOR](s.value,t.value)),c=n(()=>l[r.EMPLOYEE_BUS_LIST](s.value)),u=_(!1),e=P({columnId:s.value,gateId:void 0,num:""}),o=_([{key:"num",title:a("fields.num")},{key:"gate",title:a("fields.gate"),format:i=>{var k;return`${(k=i.route)==null?void 0:k.num} / ${i.num}`},to:i=>l[r.EMPLOYEE_GATE_VIEW](s.value,i.id)},{key:"createdAt",title:a("fields.createdAt"),format:R},{key:"updatedAt",title:a("fields.updatedAt"),format:R}]),g=n(()=>[{key:"edit",text:a("actions.edit"),to:m.value,type:"PRIMARY"},{key:"remove",text:a("actions.remove"),click:y,type:"ERROR",loading:u.value},{key:"cancel",text:a("actions.toList"),to:c.value}]),y=()=>E.confirm(a("dialogs.removeConfirm"),()=>(u.value=!0,v.buses._id.delete(t.value).then(()=>(f.success(a("alerts.removeSuccess")),d.push(c.value))).finally(()=>{u.value=!1})));return{loading:u,model:e,fields:o,actions:g,fetch:()=>(u.value=!0,v.buses._id.get(t.value).then(i=>Object.assign(e,i)).finally(()=>u.value=!1))}};export{x as a,V as b,U as u};
