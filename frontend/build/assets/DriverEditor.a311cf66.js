import{d as z,y as H,E as M,o as f,c as _,a as l,f as e,F as L,m as A,n as F,l as g,w as v,b as T,t as w,r as I,j as q,k as J,P as K,i as Q}from"./index.ecde2a89.js";import{k as W,l as x,w as X,_ as Z,b as ee}from"./dayjs.b74fc854.js";import{_ as te}from"./ServerAutocomplete.vue_vue_type_script_setup_true_lang.c1d530a7.js";import{e as O}from"./vuelidate.593c808c.js";import{a as ae}from"./composable.c193e2df.js";import"./get.0c6589df.js";var le=W,oe=1,se=4;function ne(m){return le(m,oe|se)}var j=ne;const de=[{name:"111",date:"2019-01-01",format:"\u0420\u0412"},{name:"112",date:"2019-01-02",format:"\u0420\u0412"},{name:"221",date:"2019-01-02",format:"\u0420\u0420\u0412\u0412"},{name:"222",date:"2019-01-04",format:"\u0420\u0420\u0412\u0412"},{name:"223",date:"2019-01-05",format:"\u0420\u0420\u0412\u0412"},{name:"224",date:"2019-01-03",format:"\u0420\u0420\u0412\u0412"},{name:"311",date:"2021-01-04",format:"\u0420\u0420\u0420\u0412"},{name:"312",date:"2021-01-03",format:"\u0420\u0420\u0420\u0412"},{name:"313",date:"2021-01-02",format:"\u0420\u0420\u0420\u0412"},{name:"314",date:"2021-01-01",format:"\u0420\u0420\u0420\u0412"},{name:"421",date:"2019-01-05",format:"\u0420\u0420\u0420\u0420\u0412\u0412"},{name:"422",date:"2019-01-06",format:"\u0420\u0420\u0420\u0420\u0412\u0412"},{name:"423",date:"2019-01-07",format:"\u0420\u0420\u0420\u0420\u0412\u0412"},{name:"424",date:"2019-01-08",format:"\u0420\u0420\u0420\u0420\u0412\u0412"},{name:"425",date:"2019-01-09",format:"\u0420\u0420\u0420\u0420\u0412\u0412"},{name:"426",date:"2019-01-10",format:"\u0420\u0420\u0420\u0420\u0412\u0412"},{name:"521",date:"2019-01-07",format:"\u0420\u0420\u0420\u0420\u0420\u0412\u0412"},{name:"522",date:"2019-01-08",format:"\u0420\u0420\u0420\u0420\u0420\u0412\u0412"},{name:"523",date:"2019-01-09",format:"\u0420\u0420\u0420\u0420\u0420\u0412\u0412"},{name:"524",date:"2019-01-10",format:"\u0420\u0420\u0420\u0420\u0420\u0412\u0412"},{name:"525",date:"2019-01-11",format:"\u0420\u0420\u0420\u0420\u0420\u0412\u0412"},{name:"526",date:"2019-01-12",format:"\u0420\u0420\u0420\u0420\u0420\u0412\u0412"},{name:"527",date:"2019-01-13",format:"\u0420\u0420\u0420\u0420\u0420\u0412\u0412"},{name:"611",date:"2019-01-08",format:"\u0420\u0420\u0420\u0420\u0420\u0420\u0412"},{name:"612",date:"2019-01-09",format:"\u0420\u0420\u0420\u0420\u0420\u0420\u0412"},{name:"613",date:"2019-01-10",format:"\u0420\u0420\u0420\u0420\u0420\u0420\u0412"},{name:"614",date:"2019-01-11",format:"\u0420\u0420\u0420\u0420\u0420\u0420\u0412"},{name:"615",date:"2019-01-12",format:"\u0420\u0420\u0420\u0420\u0420\u0420\u0412"},{name:"616",date:"2019-01-13",format:"\u0420\u0420\u0420\u0420\u0420\u0420\u0412"},{name:"617",date:"2019-01-14",format:"\u0420\u0420\u0420\u0420\u0420\u0420\u0412"}],re={key:0,class:"ge-statuses"},me=["onClick"],ue={key:1,class:"ge-calendar"},ie={class:"ge-calendar__header"},ce={class:"ge-calendar__prev"},fe={class:"ge-calendar__title"},_e={class:"ge-calendar__next"},ve={class:"ge-calendar__body"},pe={class:"ge-calendar__day"},be={class:"ge-calendar__day"},ge={class:"ge-calendar__day-index"},he={class:"ge-calendar__day-value"},Ve=z({__name:"GraphicEditor",props:{modelValue:null,label:null},emits:["update:model-value"],setup(m,{emit:u}){const i=m;x.locale("ru"),x.extend(X);const n=H(x().date(1)),Y=M(()=>(n.value.day()+6)%7),$=M(()=>i.modelValue?s(i.modelValue,n.value.format("YYYY-MM-DD"),n.value.daysInMonth()):[]),C=()=>{n.value=n.value.subtract(1,"month")},d=()=>{n.value=n.value.add(1,"month")},h=a=>{const t={...a,items:a.format.split("")};u("update:model-value",t)},S=a=>{!i.modelValue||u("update:model-value",N(i.modelValue,a))},U=()=>{!i.modelValue||u("update:model-value",B(i.modelValue))},D=()=>{!i.modelValue||u("update:model-value",E(i.modelValue))};function B(a){const t=j(a);return t.items=t.items.concat(a.format.split("")),t}function E(a){const t=j(a);return t.items=t.items.slice(0,-a.format.length),t}const o=["\u0420","1","2"],V=["\u0412","\u041E"];function N(a,t){const b=j(a),r=b.items[t];let c;return o.includes(r)?(c=y(r,o),b.items[t]=c):V.includes(r)&&(c=y(r,V),b.items[t]=c),b}function y(a,t){const r=(t.findIndex(c=>c==a)+1)%t.length;return t[r]}function s(a,t,b=1){const r=[],c=x(a.date),p=a.items;let k=x(t);for(let G=0;G<b;G++){const P=(k.diff(c,"days")%p.length+p.length)%p.length,R=p[P];r.push({date:k.format("YYYY-MM-DD"),value:R}),k=k.add(1,"days")}return r}return(a,t)=>{const b=I("v-autocomplete"),r=I("v-icon"),c=I("v-btn");return f(),_("div",null,[l(b,{"model-value":m.modelValue,items:e(de),"menu-props":{maxHeight:"300px"},label:m.label,"return-object":"","hide-details":"","item-value":"name","item-title":"name","onUpdate:modelValue":h},null,8,["model-value","items","label"]),m.modelValue?(f(),_("div",re,[(f(!0),_(L,null,A(m.modelValue.items,(p,k)=>(f(),_("div",{class:"ge-statuses__item ge-statuses__item--clickable",onClick:G=>S(k)},w(p),9,me))),256)),m.modelValue.format.length<m.modelValue.items.length?(f(),_("div",{key:0,class:"ge-statuses__item ge-statuses__item--clickable",onClick:D}," - ")):F("",!0),g("div",{class:"ge-statuses__item ge-statuses__item--clickable",onClick:U},"+")])):F("",!0),m.modelValue?(f(),_("div",ue,[g("div",ie,[g("div",ce,[l(c,{rounded:"",icon:"",flat:"",size:"small",onClick:C},{default:v(()=>[l(r,null,{default:v(()=>[T("mdi-chevron-left")]),_:1})]),_:1})]),g("div",fe,w(n.value.format("MMM YYYY")),1),g("div",_e,[l(c,{rounded:"",icon:"",flat:"",size:"small",onClick:d},{default:v(()=>[l(r,null,{default:v(()=>[T("mdi-chevron-right")]),_:1})]),_:1})])]),g("div",ve,[(f(!0),_(L,null,A(e(Y),p=>(f(),_("div",pe))),256)),(f(!0),_(L,null,A(e($),p=>(f(),_("div",be,[g("div",ge,w(e(x)(p.date).date()),1),g("div",he,w(p.value),1)]))),256))])])):F("",!0)])}}}),Ye=z({__name:"DriverEditor",setup(m){const{t:u}=q(),i=Q(),n=M(()=>+i.params.id),Y=M(()=>+i.params.columnId),$=M(()=>n.value?u("drivers.editorTitle"):u("drivers.creatorTitle")),{loading:C,model:d,v$:h,actions:S,fetch:U,save:D}=ae(Y,n),B=E=>ee.buses.get({...E,columnId:Y.value});return J(()=>{n.value&&U()}),(E,o)=>{const V=I("v-col"),N=I("v-text-field"),y=I("v-row");return f(),_("form",{onSubmit:o[5]||(o[5]=K((...s)=>e(D)&&e(D)(...s),["prevent"]))},[g("h1",null,w(e($)),1),l(y,{class:"pt-8"},{default:v(()=>[l(V,{cols:"12",md:"6",lg:"4"},{default:v(()=>[l(y,null,{default:v(()=>[l(V,{cols:"12"},{default:v(()=>[l(e(te),{modelValue:e(d).bus,"onUpdate:modelValue":o[0]||(o[0]=s=>e(d).bus=s),"model-value-id":e(d).busId,"onUpdate:model-value-id":o[1]||(o[1]=s=>e(d).busId=s),fetch:B,disabled:e(C),error:e(h).busId.$error,"error-messages":e(O)(e(h).busId.$errors),label:e(u)("fields.bus"),"item-title":"num"},null,8,["modelValue","model-value-id","disabled","error","error-messages","label"])]),_:1}),l(V,{cols:"12"},{default:v(()=>[l(N,{modelValue:e(d).num,"onUpdate:modelValue":o[2]||(o[2]=s=>e(d).num=s),disabled:e(C),error:e(h).num.$error,"error-messages":e(O)(e(h).num.$errors),label:e(u)("fields.num")},null,8,["modelValue","disabled","error","error-messages","label"])]),_:1}),l(V,{cols:"12"},{default:v(()=>[l(N,{modelValue:e(d).fullName,"onUpdate:modelValue":o[3]||(o[3]=s=>e(d).fullName=s),disabled:e(C),error:e(h).fullName.$error,"error-messages":e(O)(e(h).fullName.$errors),label:e(u)("fields.fullName")},null,8,["modelValue","disabled","error","error-messages","label"])]),_:1})]),_:1})]),_:1}),l(V,{cols:"12",md:"6",lg:"4"},{default:v(()=>[l(e(Ve),{modelValue:e(d).graphic,"onUpdate:modelValue":o[4]||(o[4]=s=>e(d).graphic=s),label:e(u)("fields.graphic")},null,8,["modelValue","label"])]),_:1})]),_:1}),l(e(Z),{actions:e(S),class:"pt-8"},null,8,["actions"])],32)}}});export{Ye as default};
