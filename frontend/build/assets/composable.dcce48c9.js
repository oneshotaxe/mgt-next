import{j as _,M,O as S,E as s,y as p,C as w,h,R as u,N as i}from"./index.a8fbf8fe.js";import{u as N,f as A,a as T,r as g,m as j,b as c}from"./dayjs.7d66ce39.js";const L=e=>{const{t}=_(),d=h(),v=M(),f=S(),m=s(()=>u[i.ADMIN_USER_LIST]),l=k=>u[i.ADMIN_USER_VIEW](k),o=s(()=>e.value?l(e.value):m.value),a=p(["admin","employee"]),y=s(()=>!e.value),n=p(!1),r=w({nick:"",password:void 0,roles:[]}),I=s(()=>y.value?{required:g,minLength:j(8)}:{}),R=s(()=>({nick:{required:g},password:I.value,roles:{required:g}})),E=N(R,r),D=s(()=>[{key:"save",text:t("actions.save"),buttonType:"submit",type:"PRIMARY",loading:n.value},{key:"cancel",text:t("actions.cancel"),to:o.value}]);return{roles:a,showPasswordField:y,loading:n,model:r,v$:E,actions:D,save:async()=>{if(!!await E.value.$validate())return v.confirm(t("dialogs.saveConfirm"),()=>(n.value=!0,(e.value?c.users._id.put(e.value,r).then(()=>e.value):c.users._id.post(r)).then(b=>(f.success(t("alerts.saveSuccess")),d.push(l(b)))).finally(()=>{n.value=!1})))},fetch:()=>(n.value=!0,c.users._id.get(e.value).then(k=>Object.assign(r,k)).finally(()=>n.value=!1))}},P=()=>{const{t:e}=_(),t=h(),d=s(()=>u[i.ADMIN_USER_CREATOR]),v=a=>u[i.ADMIN_USER_VIEW](a),f=p([{key:"id",title:e("fields.id")},{key:"nick",title:e("fields.nick")},{key:"roles",title:e("fields.roles"),format:a=>a.join(", ")},{key:"createdAt",title:e("fields.createdAt"),format:A},{key:"updatedAt",title:e("fields.updatedAt"),format:A}]),m=T({order:"created_at desc",page:1,pageSize:10,fetch:c.users.get}),l=s(()=>[{key:"create",to:d.value,text:e("actions.create"),type:"PRIMARY",prependIcon:"mdi-plus"}]);return{columns:f,table:m,actions:l,onRowClick:a=>t.push(v(a))}},V=e=>{const{t}=_(),d=h(),v=M(),f=S(),m=s(()=>u[i.ADMIN_USER_EDITOR](e.value)),l=s(()=>u[i.ADMIN_USER_LIST]),o=p(!1),a=w({nick:"",roles:[]}),y=p([{key:"id",title:t("fields.id")},{key:"nick",title:t("fields.nick")},{key:"roles",title:t("fields.roles"),format:R=>R.join(", ")},{key:"createdAt",title:t("fields.createdAt"),format:A},{key:"updatedAt",title:t("fields.updatedAt"),format:A}]),n=s(()=>[{key:"edit",text:t("actions.edit"),to:m.value,type:"PRIMARY"},{key:"remove",text:t("actions.remove"),click:r,type:"ERROR",loading:o.value},{key:"cancel",text:t("actions.toList"),to:l.value}]),r=()=>v.confirm(t("dialogs.removeConfirm"),()=>(o.value=!0,c.users._id.delete(e.value).then(()=>(f.success(t("alerts.removeSuccess")),d.push(l.value))).finally(()=>{o.value=!1})));return{loading:o,model:a,fields:y,actions:n,fetch:()=>(o.value=!0,c.users._id.get(e.value).then(R=>Object.assign(a,R)).finally(()=>o.value=!1))}};export{L as a,V as b,P as u};
